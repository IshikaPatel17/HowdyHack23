<!DOCTYPE html>

<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <form>
        <div class="form-group row">
            <label for="inputEmail3" class="col-sm-2 col-form-label">Name</label>
            <div class="col-sm-10">
                <input class="form-control" id="name" placeholder="Name">
            </div>
        </div>
        <div class="form-group row">
            <label for="inputEmail3" class="col-sm-2 col-form-label">Email</label>
            <div class="col-sm-10">
                <input class="form-control" id="email" placeholder="Email">
            </div>
        </div>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label">Username</label>
            <div class="col-sm-10">
                <input class="form-control" id="username" placeholder="Username">
            </div>
        </div>
        <div class="form-group row">
            <label for="inputPassword3" class="col-sm-2 col-form-label">Password</label>
            <div class="col-sm-10">
                <input type="password" class="form-control" id="password" placeholder="Password">
            </div>
        </div>
        <fieldset class="form-group">
            <div class="row">
                <legend class="col-form-label col-sm-2 pt-0">Account type</legend>
                <div class="col-sm-10">
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="gridRadios" id="gridRadios1" value="option1"
                            checked>
                        <label class="form-check-label" for="gridRadios1">
                            I am signing up as a hero(tutor)
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="gridRadios" id="gridRadios2" value="option2">
                        <label class="form-check-label" for="gridRadios2">
                            I am signing up as a student
                        </label>
                    </div>
                </div>
            </div>
        </fieldset>
        <div class="form-group row">
            <div class="col-sm-10">
                <button type="submit" id="SignupBtn">Sign up</button>
            </div>
        </div>
    </form>
</head>

<body>
    <script type='module'>
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "firebase/app";
        import { getAnalytics } from "firebase/analytics";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "AIzaSyBwCOZyWSaa0xswC4CFLRT1-Kf5ZDeojyo",
            authDomain: "hack23-d29c9.firebaseapp.com",
            databaseURL: "https://hack23-d29c9-default-rtdb.firebaseio.com",
            projectId: "hack23-d29c9",
            storageBucket: "hack23-d29c9.appspot.com",
            messagingSenderId: "991221953378",
            appId: "1:991221953378:web:14fae9949ac2e35d8d323b",
            measurementId: "G-LK91YT4F18"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);

        function FindData() {
            const dbref = ref(db);

            get(child(dbref, "" + document.getElementById('nameBoxSignIn').value))
                .then((snapshot) => {
                    if (snapshot.exists()) {
                        if (snapshot.val().Password == document.getElementById('passwordBoxSignIn').value && snapshot.val().Email == document.getElementById('emailBoxSignIn').value) {
                            document.getElementById('info').innerHTML = "Welcome Back " + snapshot.val().Name;
                            //window.location.href = 'homepage.html'
                        } else {
                            //console.log(snapshot.val().Password)
                            //console.log(document.getElementById('passwordBoxSignIn').value)
                            document.getElementById('info').innerHTML = "Incorrect Password";
                        }

                    } else {
                        alert("This Account Does not exist");
                    }
                })
                .catch((error) => {
                    alert(error)
                })

        }
        function InsertData() {
            set(ref(db, "" + document.getElementById('username').value), { Name: document.getElementById('name'), Username: document.getElementById('username').value, Email: document.getElementById('email').value, Password: document.getElementById('password').value, })
                .then((userCredential) => {
                    window.location.href = "homepage.html";
                })
                .catch((error) => {
                    //alert(error);
                });

        }

        document.addEventListener('DOMContentLoaded', () => {
            let btn = document.getElementById('SignupBtn')
            btn.addEventListener('click', function (evt) {
                console.log("works")
                InsertData();
                clearFields();
            })
        })
        document.addEventListener('DOMContentLoaded', () => {
            let btn = document.getElementById('LoginBtn')
            btn.addEventListener('click', function (evt) {
                FindData();
                clearFields();
            })
        })
    </script>
</body>